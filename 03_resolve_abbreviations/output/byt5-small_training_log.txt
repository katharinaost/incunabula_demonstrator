> python .\finetune_byt5-small.py
Train size: 2164, Val size: 270, Test size: 272
Map: 100%|████████████████████████████████████████████████████████████████| 2164/2164 [00:00<00:00, 5975.50 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████| 270/270 [00:00<00:00, 7042.54 examples/s]
Map: 100%|██████████████████████████████████████████████████████████████████| 272/272 [00:00<00:00, 7432.64 examples/s]
{'loss': 2.6316, 'grad_norm': 73.43355560302734, 'learning_rate': 1.845018450184502e-05, 'epoch': 0.37}
{'loss': 1.6684, 'grad_norm': 15.022311210632324, 'learning_rate': 3.690036900369004e-05, 'epoch': 0.74}
{'eval_loss': 0.3962123990058899, 'eval_cer': 0.3252075471698113, 'eval_exact_match': 0.007407407407407408, 'eval_runtime': 215.0267, 'eval_samples_per_second': 1.256, 'eval_steps_per_second': 0.628, 'epoch': 1.0}
{'loss': 0.803, 'grad_norm': 5.4716997146606445, 'learning_rate': 5.535055350553506e-05, 'epoch': 1.11}
{'loss': 0.4458, 'grad_norm': 1.9716717004776, 'learning_rate': 7.380073800738008e-05, 'epoch': 1.48}
{'loss': 0.3174, 'grad_norm': 1.5910989046096802, 'learning_rate': 9.22509225092251e-05, 'epoch': 1.85}
{'eval_loss': 0.1097913607954979, 'eval_cer': 0.044, 'eval_exact_match': 0.3333333333333333, 'eval_runtime': 182.194, 'eval_samples_per_second': 1.482, 'eval_steps_per_second': 0.741, 'epoch': 2.0}
{'loss': 0.2137, 'grad_norm': 3.2139925956726074, 'learning_rate': 9.88109881098811e-05, 'epoch': 2.21}
{'loss': 0.1655, 'grad_norm': 1.3717164993286133, 'learning_rate': 9.67609676096761e-05, 'epoch': 2.58}
{'loss': 0.139, 'grad_norm': 1.2777143716812134, 'learning_rate': 9.471094710947111e-05, 'epoch': 2.95}
{'eval_loss': 0.0681428387761116, 'eval_cer': 0.02860377358490566, 'eval_exact_match': 0.5222222222222223, 'eval_runtime': 186.6811, 'eval_samples_per_second': 1.446, 'eval_steps_per_second': 0.723, 'epoch': 3.0}
{'loss': 0.113, 'grad_norm': 0.7035496830940247, 'learning_rate': 9.266092660926609e-05, 'epoch': 3.32}
{'loss': 0.1032, 'grad_norm': 1.005865216255188, 'learning_rate': 9.06109061090611e-05, 'epoch': 3.69}
{'eval_loss': 0.059045057743787766, 'eval_cer': 0.021811320754716982, 'eval_exact_match': 0.5555555555555556, 'eval_runtime': 186.5921, 'eval_samples_per_second': 1.447, 'eval_steps_per_second': 0.724, 'epoch': 4.0}
{'loss': 0.0933, 'grad_norm': 0.6928822994232178, 'learning_rate': 8.85608856088561e-05, 'epoch': 4.06}
{'loss': 0.0765, 'grad_norm': 0.8253739476203918, 'learning_rate': 8.65108651086511e-05, 'epoch': 4.43}
{'loss': 0.074, 'grad_norm': 0.5112669467926025, 'learning_rate': 8.446084460844609e-05, 'epoch': 4.8}
{'eval_loss': 0.05084184184670448, 'eval_cer': 0.018867924528301886, 'eval_exact_match': 0.5925925925925926, 'eval_runtime': 192.8459, 'eval_samples_per_second': 1.4, 'eval_steps_per_second': 0.7, 'epoch': 5.0}
{'loss': 0.071, 'grad_norm': 0.7712017297744751, 'learning_rate': 8.241082410824109e-05, 'epoch': 5.17}
{'loss': 0.0612, 'grad_norm': 2.842268705368042, 'learning_rate': 8.036080360803608e-05, 'epoch': 5.54}
{'loss': 0.0653, 'grad_norm': 1.4359409809112549, 'learning_rate': 7.831078310783109e-05, 'epoch': 5.9}
{'eval_loss': 0.046548739075660706, 'eval_cer': 0.01720754716981132, 'eval_exact_match': 0.674074074074074, 'eval_runtime': 186.4227, 'eval_samples_per_second': 1.448, 'eval_steps_per_second': 0.724, 'epoch': 6.0}
{'loss': 0.0526, 'grad_norm': 1.008666753768921, 'learning_rate': 7.626076260762607e-05, 'epoch': 6.27}
{'loss': 0.0556, 'grad_norm': 1.1854348182678223, 'learning_rate': 7.421074210742108e-05, 'epoch': 6.64}
{'eval_loss': 0.04771960899233818, 'eval_cer': 0.014943396226415094, 'eval_exact_match': 0.6592592592592592, 'eval_runtime': 185.4674, 'eval_samples_per_second': 1.456, 'eval_steps_per_second': 0.728, 'epoch': 7.0}
{'loss': 0.0509, 'grad_norm': 0.6590613126754761, 'learning_rate': 7.216072160721608e-05, 'epoch': 7.01}
{'loss': 0.0432, 'grad_norm': 0.9918625950813293, 'learning_rate': 7.011070110701108e-05, 'epoch': 7.38}
{'loss': 0.0462, 'grad_norm': 0.9345108866691589, 'learning_rate': 6.806068060680607e-05, 'epoch': 7.75}
{'eval_loss': 0.048307113349437714, 'eval_cer': 0.015018867924528301, 'eval_exact_match': 0.6851851851851852, 'eval_runtime': 186.8823, 'eval_samples_per_second': 1.445, 'eval_steps_per_second': 0.722, 'epoch': 8.0}
{'loss': 0.0418, 'grad_norm': 0.3670119345188141, 'learning_rate': 6.601066010660108e-05, 'epoch': 8.12}
{'loss': 0.0399, 'grad_norm': 0.7269070744514465, 'learning_rate': 6.396063960639606e-05, 'epoch': 8.49}
{'loss': 0.0396, 'grad_norm': 0.4428386688232422, 'learning_rate': 6.191061910619107e-05, 'epoch': 8.86}
{'eval_loss': 0.04795607924461365, 'eval_cer': 0.014641509433962264, 'eval_exact_match': 0.6777777777777778, 'eval_runtime': 181.0442, 'eval_samples_per_second': 1.491, 'eval_steps_per_second': 0.746, 'epoch': 9.0}
{'loss': 0.0337, 'grad_norm': 0.15608574450016022, 'learning_rate': 5.986059860598606e-05, 'epoch': 9.23}
{'loss': 0.0343, 'grad_norm': 0.4583209753036499, 'learning_rate': 5.7810578105781064e-05, 'epoch': 9.59}
{'loss': 0.0328, 'grad_norm': 0.6152193546295166, 'learning_rate': 5.576055760557606e-05, 'epoch': 9.96}
{'eval_loss': 0.047241754829883575, 'eval_cer': 0.012905660377358491, 'eval_exact_match': 0.6962962962962963, 'eval_runtime': 186.0488, 'eval_samples_per_second': 1.451, 'eval_steps_per_second': 0.726, 'epoch': 10.0}
{'loss': 0.031, 'grad_norm': 0.5967200398445129, 'learning_rate': 5.371053710537106e-05, 'epoch': 10.33}
{'loss': 0.0308, 'grad_norm': 1.642278790473938, 'learning_rate': 5.166051660516605e-05, 'epoch': 10.7}
{'eval_loss': 0.043863873928785324, 'eval_cer': 0.013132075471698113, 'eval_exact_match': 0.7037037037037037, 'eval_runtime': 183.3014, 'eval_samples_per_second': 1.473, 'eval_steps_per_second': 0.736, 'epoch': 11.0}
{'loss': 0.0312, 'grad_norm': 0.5190723538398743, 'learning_rate': 4.9610496104961054e-05, 'epoch': 11.07}
{'loss': 0.0254, 'grad_norm': 1.0439929962158203, 'learning_rate': 4.756047560475605e-05, 'epoch': 11.44}
{'loss': 0.0273, 'grad_norm': 1.0521268844604492, 'learning_rate': 4.5510455104551046e-05, 'epoch': 11.81}
{'eval_loss': 0.046860385686159134, 'eval_cer': 0.013132075471698113, 'eval_exact_match': 0.6851851851851852, 'eval_runtime': 199.4603, 'eval_samples_per_second': 1.354, 'eval_steps_per_second': 0.677, 'epoch': 12.0}
{'loss': 0.0267, 'grad_norm': 0.7224321961402893, 'learning_rate': 4.346043460434604e-05, 'epoch': 12.18}
{'loss': 0.0257, 'grad_norm': 0.16411936283111572, 'learning_rate': 4.1410414104141045e-05, 'epoch': 12.55}
{'loss': 0.025, 'grad_norm': 0.6729299426078796, 'learning_rate': 3.936039360393604e-05, 'epoch': 12.92}
{'eval_loss': 0.0476718470454216, 'eval_cer': 0.013207547169811321, 'eval_exact_match': 0.674074074074074, 'eval_runtime': 197.7029, 'eval_samples_per_second': 1.366, 'eval_steps_per_second': 0.683, 'epoch': 13.0}
 65%|█████████████████████████████████████████████████▍                          | 3523/5420 [1:04:24<11:40,  2.71it/s]There were missing keys in the checkpoint model loaded: ['encoder.embed_tokens.weight', 'decoder.embed_tokens.weight'].
{'train_runtime': 3874.3934, 'train_samples_per_second': 11.171, 'train_steps_per_second': 1.399, 'train_loss': 0.21974248775121605, 'epoch': 13.0}
 65%|█████████████████████████████████████████████████▍                          | 3523/5420 [1:04:34<34:46,  1.10s/it]
100%|████████████████████████████████████████████████████████████████████████████████| 136/136 [03:07<00:00,  1.38s/it]
Test metrics: PredictionOutput(predictions=array([[   0,  118,  120, ..., -100, -100, -100],
       [   0,   72,  106, ..., -100, -100, -100],
       [   0,  102,  120, ..., -100, -100, -100],
       ...,
       [   0,  103,  104, ..., -100, -100, -100],
       [   0,  115,  114, ..., -100, -100, -100],
       [   0,  104,  113, ..., -100, -100, -100]], dtype=int64), label_ids=array([[ 118,  120,  113, ..., -100, -100, -100],
       [  72,  106,  117, ..., -100, -100, -100],
       [ 102,  120,  111, ..., -100, -100, -100],
       ...,
       [ 103,  104,  118, ..., -100, -100, -100],
       [ 115,  114,  119, ..., -100, -100, -100],
       [ 104,  113,  108, ..., -100, -100, -100]], dtype=int64), metrics={'test_loss': 0.046186499297618866, 'test_cer': 0.014442651916724284, 'test_exact_match': 0.7242647058823529, 'test_runtime': 189.2907, 'test_samples_per_second': 1.437, 'test_steps_per_second': 0.718})